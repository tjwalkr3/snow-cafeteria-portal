@page "/breakfast-demo"
@rendermode InteractiveServer
@using Cafeteria.Customer.Components.Pages.SelectionModal
@using Cafeteria.Shared.DTOs

<PageTitle>Breakfast Station Demo</PageTitle>

<div class="container my-5">
    <h1 class="text-center mb-5">
        <i class="bi bi-egg-fried me-3"></i>Breakfast Station
    </h1>

    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card border-warning shadow-sm">
                <div class="card-header bg-warning text-dark text-center py-3">
                    <h4 class="mb-0">
                        <i class="bi bi-credit-card me-2"></i>Meal Plan/Swipe Orders
                    </h4>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-4">
                        <i class="bi bi-info-circle me-2"></i>
                        Choose ONE breakfast option for a swipe. Each option will come with a fountain drink. 
                        <span class="text-danger fw-bold">NO SUBSTITUTIONS!</span>
                    </p>
                    
                    <div class="row mb-4">
                        <div class="col-12">
                            <h6 class="fw-bold mb-2">Breakfast Options:</h6>
                            <div class="list-group list-group-flush">
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>Breakfast Sandwich
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>Breakfast Burrito
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>1 Pancake and Potatoes
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>1 Pancake and Choice of ONE Meat
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>French Toast and Potatoes
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>1 Biscuit and Gravy with Potatoes
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-check-circle text-warning me-2"></i>Breakfast Plate
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-12">
                            <h6 class="fw-bold mb-2">Side Options:</h6>
                            <div class="list-group list-group-flush">
                                <div class="list-group-item py-1">
                                    <i class="bi bi-circle text-muted me-2"></i>Toast
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-circle text-muted me-2"></i>Bacon
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-circle text-muted me-2"></i>Sausage Link
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-circle text-muted me-2"></i>Tater Tots
                                </div>
                                <div class="list-group-item py-1">
                                    <i class="bi bi-circle text-muted me-2"></i>Potatoes
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-warning btn-lg w-100" @onclick="OpenBreakfastModal">
                        <i class="bi bi-plus-circle me-2"></i>Order with Meal Swipe
                    </button>
                </div>
            </div>
        </div>
    </div>

    @if (orderConfirmation != null)
    {
        <div class="alert alert-success alert-dismissible fade show mt-5" role="alert">
            <h5 class="alert-heading">
                <i class="bi bi-check-circle-fill me-2"></i>Order Added!
            </h5>
            <hr>
            <p class="mb-0"><strong>@orderConfirmation</strong></p>
            <button type="button" class="btn-close" @onclick="() => orderConfirmation = null"></button>
        </div>
    }
</div>

<BreakfastSwipeModal 
    IsOpen="@showBreakfastModal"
    OnClose="@CloseBreakfastModal"
    OnOrderSelected="@HandleBreakfastOrder"
    Entrees="@breakfastEntrees"
    Sides="@breakfastSides"
    Drinks="@breakfastDrinks" />

@code {
    private bool showBreakfastModal = false;
    private string? orderConfirmation = null;

    private List<EntreeDto> breakfastEntrees = new List<EntreeDto>
    {
        new EntreeDto { Id = 1, StationId = 1, EntreeName = "Breakfast Sandwich", EntreeDescription = "Bread: English Muffin or Biscuit. ONE CHOICE of Meat: Sausage, Bacon, or Ham", EntreePrice = 4.99m },
        new EntreeDto { Id = 2, StationId = 1, EntreeName = "Breakfast Burrito", EntreeDescription = "Eggs, potatoes, cheese and choice of ONE MEAT: Bacon, Ham, or Sausage", EntreePrice = 5.29m },
        new EntreeDto { Id = 3, StationId = 1, EntreeName = "1 Pancake and Potatoes", EntreePrice = 4.49m },
        new EntreeDto { Id = 4, StationId = 1, EntreeName = "1 Pancake and Choice of ONE Meat", EntreeDescription = "Sausage, Bacon, or Ham", EntreePrice = 4.99m },
        new EntreeDto { Id = 5, StationId = 1, EntreeName = "French Toast and Potatoes", EntreePrice = 4.79m },
        new EntreeDto { Id = 6, StationId = 1, EntreeName = "1 Biscuit and Gravy with Potatoes", EntreePrice = 4.49m },
        new EntreeDto { Id = 7, StationId = 1, EntreeName = "Breakfast Plate", EntreeDescription = "Scrambled eggs, potatoes, one slice of toast and ONE choice of meat: Sausage, Bacon, or Ham", EntreePrice = 5.49m }
    };

    private List<SideDto> breakfastSides = new List<SideDto>
    {
        new SideDto { Id = 1, StationId = 1, SideName = "Toast", SidePrice = 1.49m },
        new SideDto { Id = 2, StationId = 1, SideName = "Bacon", SidePrice = 2.29m },
        new SideDto { Id = 3, StationId = 1, SideName = "Sausage Link", SidePrice = 2.29m },
        new SideDto { Id = 4, StationId = 1, SideName = "Tater Tots", SidePrice = 2.79m },
        new SideDto { Id = 5, StationId = 1, SideName = "Potatoes", SidePrice = 1.99m }
    };

    private List<DrinkDto> breakfastDrinks = new List<DrinkDto>
    {
        new DrinkDto { Id = 1, StationId = 1, DrinkName = "Fountain Drinks", DrinkDescription = "Included with your meal", DrinkPrice = 0.00m },
        new DrinkDto { Id = 2, StationId = 1, DrinkName = "Slushies", DrinkDescription = "Included with your meal", DrinkPrice = 0.00m },
        new DrinkDto { Id = 3, StationId = 1, DrinkName = "Tea/Coffee Machines", DrinkDescription = "Included with your meal", DrinkPrice = 0.00m },
        new DrinkDto { Id = 4, StationId = 1, DrinkName = "Tea/Coffee Fridge", DrinkDescription = "Included with your meal", DrinkPrice = 0.00m },
        new DrinkDto { Id = 5, StationId = 1, DrinkName = "Drink Fridge", DrinkDescription = "Included with your meal", DrinkPrice = 0.00m }
    };

    private void OpenBreakfastModal()
    {
        showBreakfastModal = true;
    }

    private void CloseBreakfastModal()
    {
        showBreakfastModal = false;
    }

    private void HandleBreakfastOrder(MealDto meal)
    {
        var entree = breakfastEntrees.FirstOrDefault(e => e.Id == meal.EntreeId);
        var side = breakfastSides.FirstOrDefault(s => s.Id == meal.SideId);
        var drink = breakfastDrinks.FirstOrDefault(d => d.Id == meal.DrinkId);

        orderConfirmation = $"Meal Plan/Swipe: {entree?.EntreeName ?? "Unknown"} with {side?.SideName ?? "Unknown"}";
        
        Console.WriteLine($"Breakfast Order: EntreeId={meal.EntreeId}, SideId={meal.SideId}, DrinkId={meal.DrinkId}");
    }
}
